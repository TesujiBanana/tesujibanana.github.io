require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(a){if(null==a)return"";var b,d,e,f,g,h,i,j="",k=0;for(a=c.compress(a);k<2*a.length;)k%2==0?(b=a.charCodeAt(k/2)>>8,d=255&a.charCodeAt(k/2),e=k/2+1<a.length?a.charCodeAt(k/2+1)>>8:0/0):(b=255&a.charCodeAt((k-1)/2),(k+1)/2<a.length?(d=a.charCodeAt((k+1)/2)>>8,e=255&a.charCodeAt((k+1)/2)):d=e=0/0),k+=3,f=b>>2,g=(3&b)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),j=j+c._keyStr.charAt(f)+c._keyStr.charAt(g)+c._keyStr.charAt(h)+c._keyStr.charAt(i);return j},decompressFromBase64:function(a){if(null==a)return"";var b,d,e,f,g,h,i,j,k="",l=0,m=0,n=c._f;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");m<a.length;)g=c._keyStr.indexOf(a.charAt(m++)),h=c._keyStr.indexOf(a.charAt(m++)),i=c._keyStr.indexOf(a.charAt(m++)),j=c._keyStr.indexOf(a.charAt(m++)),d=g<<2|h>>4,e=(15&h)<<4|i>>2,f=(3&i)<<6|j,l%2==0?(b=d<<8,64!=i&&(k+=n(b|e)),64!=j&&(b=f<<8)):(k+=n(b|d),64!=i&&(b=e<<8),64!=j&&(k+=n(b|f))),l+=3;return c.decompress(k)},compressToUTF16:function(a){if(null==a)return"";var b,d,e,f="",g=0,h=c._f;for(a=c.compress(a),b=0;b<a.length;b++)switch(d=a.charCodeAt(b),g++){case 0:f+=h((d>>1)+32),e=(1&d)<<14;break;case 1:f+=h(e+(d>>2)+32),e=(3&d)<<13;break;case 2:f+=h(e+(d>>3)+32),e=(7&d)<<12;break;case 3:f+=h(e+(d>>4)+32),e=(15&d)<<11;break;case 4:f+=h(e+(d>>5)+32),e=(31&d)<<10;break;case 5:f+=h(e+(d>>6)+32),e=(63&d)<<9;break;case 6:f+=h(e+(d>>7)+32),e=(127&d)<<8;break;case 7:f+=h(e+(d>>8)+32),e=(255&d)<<7;break;case 8:f+=h(e+(d>>9)+32),e=(511&d)<<6;break;case 9:f+=h(e+(d>>10)+32),e=(1023&d)<<5;break;case 10:f+=h(e+(d>>11)+32),e=(2047&d)<<4;break;case 11:f+=h(e+(d>>12)+32),e=(4095&d)<<3;break;case 12:f+=h(e+(d>>13)+32),e=(8191&d)<<2;break;case 13:f+=h(e+(d>>14)+32),e=(16383&d)<<1;break;case 14:f+=h(e+(d>>15)+32,(32767&d)+32),g=0}return f+h(e+32)},decompressFromUTF16:function(a){if(null==a)return"";for(var b,d,e="",f=0,g=0,h=c._f;g<a.length;){switch(d=a.charCodeAt(g)-32,f++){case 0:b=d<<1;break;case 1:e+=h(b|d>>14),b=(16383&d)<<2;break;case 2:e+=h(b|d>>13),b=(8191&d)<<3;break;case 3:e+=h(b|d>>12),b=(4095&d)<<4;break;case 4:e+=h(b|d>>11),b=(2047&d)<<5;break;case 5:e+=h(b|d>>10),b=(1023&d)<<6;break;case 6:e+=h(b|d>>9),b=(511&d)<<7;break;case 7:e+=h(b|d>>8),b=(255&d)<<8;break;case 8:e+=h(b|d>>7),b=(127&d)<<9;break;case 9:e+=h(b|d>>6),b=(63&d)<<10;break;case 10:e+=h(b|d>>5),b=(31&d)<<11;break;case 11:e+=h(b|d>>4),b=(15&d)<<12;break;case 12:e+=h(b|d>>3),b=(7&d)<<13;break;case 13:e+=h(b|d>>2),b=(3&d)<<14;break;case 14:e+=h(b|d>>1),b=(1&d)<<15;break;case 15:e+=h(b|d),f=0}g++}return c.decompress(e)},compress:function(a){if(null==a)return"";var b,d,e,f={},g={},h="",i="",j="",k=2,l=3,m=2,n="",o=0,p=0,q=c._f;for(e=0;e<a.length;e+=1)if(h=a.charAt(e),Object.prototype.hasOwnProperty.call(f,h)||(f[h]=l++,g[h]=!0),i=j+h,Object.prototype.hasOwnProperty.call(f,i))j=i;else{if(Object.prototype.hasOwnProperty.call(g,j)){if(j.charCodeAt(0)<256){for(b=0;m>b;b++)o<<=1,15==p?(p=0,n+=q(o),o=0):p++;for(d=j.charCodeAt(0),b=0;8>b;b++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1}else{for(d=1,b=0;m>b;b++)o=o<<1|d,15==p?(p=0,n+=q(o),o=0):p++,d=0;for(d=j.charCodeAt(0),b=0;16>b;b++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1}k--,0==k&&(k=Math.pow(2,m),m++),delete g[j]}else for(d=f[j],b=0;m>b;b++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1;k--,0==k&&(k=Math.pow(2,m),m++),f[i]=l++,j=String(h)}if(""!==j){if(Object.prototype.hasOwnProperty.call(g,j)){if(j.charCodeAt(0)<256){for(b=0;m>b;b++)o<<=1,15==p?(p=0,n+=q(o),o=0):p++;for(d=j.charCodeAt(0),b=0;8>b;b++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1}else{for(d=1,b=0;m>b;b++)o=o<<1|d,15==p?(p=0,n+=q(o),o=0):p++,d=0;for(d=j.charCodeAt(0),b=0;16>b;b++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1}k--,0==k&&(k=Math.pow(2,m),m++),delete g[j]}else for(d=f[j],b=0;m>b;b++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1;k--,0==k&&(k=Math.pow(2,m),m++)}for(d=2,b=0;m>b;b++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1;for(;;){if(o<<=1,15==p){n+=q(o);break}p++}return n},decompress:function(a){if(null==a)return"";if(""==a)return null;var b,d,e,f,g,h,i,j,k=[],l=4,m=4,n=3,o="",p="",q=c._f,r={string:a,val:a.charCodeAt(0),position:32768,index:1};for(d=0;3>d;d+=1)k[d]=d;for(f=0,h=Math.pow(2,2),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;switch(b=f){case 0:for(f=0,h=Math.pow(2,8),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;j=q(f);break;case 1:for(f=0,h=Math.pow(2,16),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;j=q(f);break;case 2:return""}for(k[3]=j,e=p=j;;){if(r.index>r.string.length)return"";for(f=0,h=Math.pow(2,n),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;switch(j=f){case 0:for(f=0,h=Math.pow(2,8),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;k[m++]=q(f),j=m-1,l--;break;case 1:for(f=0,h=Math.pow(2,16),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;k[m++]=q(f),j=m-1,l--;break;case 2:return p}if(0==l&&(l=Math.pow(2,n),n++),k[j])o=k[j];else{if(j!==m)return null;o=e+e.charAt(0)}p+=o,k[m++]=e+o.charAt(0),l--,e=o,0==l&&(l=Math.pow(2,n),n++)}}};"undefined"!=typeof b&&null!=b&&(b.exports=c)},{}],2:[function(a,b){var c=a("react"),d=(a("underscore"),a("../models/board.js")),e=a("./grid_view.jsx"),f=a("./intersections_view.jsx"),g=c.createClass({displayName:"BoardView",propTypes:{onIntersectionClick:c.PropTypes.func.isRequired,board:c.PropTypes.instanceOf(d).isRequired,current_turn:c.PropTypes.number},render:function(){var a=this.props.board.board_size;return c.DOM.div({className:"tesuji-board"},e({board_size:a}),f({board:this.props.board,current_turn:this.props.current_turn,onIntersectionClick:this.props.onIntersectionClick}))}});b.exports=g},{"../models/board.js":11,"./grid_view.jsx":3,"./intersections_view.jsx":5,react:"M6d2gk",underscore:"ZKusGn"}],3:[function(a,b){"use strict";var c=a("react"),d=a("underscore"),e=c.createClass({displayName:"GridView",propTypes:{board_size:c.PropTypes.number.isRequired},render:function(){var a=this.props.board_size;return c.DOM.div({className:"tesuji-grid"},c.DOM.table(null,c.DOM.tbody(null,d.times(a-1,function(b){return c.DOM.tr({key:b},d.times(a-1,function(a){return c.DOM.td({key:a},"Â ")}))}))),d.times(a,function(a){var b="ABCDEFGHJKLMNOPQRST".charAt(a);return c.DOM.div({className:"label label-top-"+a,key:a},b)}),d.times(a,function(a){var b="ABCDEFGHJKLMNOPQRST".charAt(a);return c.DOM.div({className:"label label-bottom-"+a,key:a},b)}),d.times(a,function(a){return c.DOM.div({className:"label label-left-"+a,key:a},a+1)}),d.times(a,function(a){return c.DOM.div({className:"label label-right-"+a,key:a},a+1)}),d.times(9,function(a){var b=3+6*(a%3),d=3+2*(a-a%3);return c.DOM.div({className:"dot intersection-"+b+"-"+d,key:a})}))}});b.exports=e},{react:"M6d2gk",underscore:"ZKusGn"}],4:[function(a,b){"use strict";var c=a("react"),d=(a("../models/stone.js"),a("./stone_view.jsx")),e=c.createClass({displayName:"IntersectionView",onMouseEnter:function(a){this.props.onMouseEnter({x:this.props.x,y:this.props.y},a)},render:function(){var a=[];return this.props.stone?a.push(d({stone:this.props.stone,key:"stone"})):this.props.preview&&a.push(c.DOM.div({className:"stone preview "+this.props.preview,key:"preview"})),c.DOM.div({className:"intersection intersection-"+this.props.x+"-"+this.props.y,onMouseEnter:this.onMouseEnter},a)}});b.exports=e},{"../models/stone.js":15,"./stone_view.jsx":6,react:"M6d2gk"}],5:[function(a,b){"use strict";var c=a("react"),d=a("underscore"),e=a("../models/stone.js"),f=a("./intersection_view.jsx"),g=c.createClass({displayName:"IntersectionsView",getInitialState:function(){return{cursor_position:{x:7,y:8}}},onClick:function(a){this.props.onIntersectionClick({x:this.state.cursor_position.x,y:this.state.cursor_position.y},a)},onIntersectionEnter:function(a){this.setState({cursor_position:{x:a.x,y:a.y}})},render:function(){var a=19;return c.DOM.div({className:"intersections",onClick:this.onClick},d.times(a*a,function(b){var c=b%a,d=(b-c)/a,g=this.props.board.stoneAt(c,d),h=this.state.cursor_position.x===c&&this.state.cursor_position.y===d?this.props.current_turn===e.BLACK?"black":"white":void 0;return f({x:c,y:d,key:b,onMouseEnter:this.onIntersectionEnter,stone:g,preview:h})}.bind(this)))}});b.exports=g},{"../models/stone.js":15,"./intersection_view.jsx":4,react:"M6d2gk",underscore:"ZKusGn"}],6:[function(a,b){var c=a("react"),d=(a("underscore"),a("../models/stone.js")),e=c.createClass({displayName:"StoneView",propTypes:{stone:c.PropTypes.instanceOf(d).isRequired},color:function(){return this.props.stone.color===d.BLACK?"black":this.props.stone.color===d.WHITE?"white":void 0},render:function(){return c.DOM.div(null,c.DOM.div({className:"stone "+this.color()}),c.DOM.div({className:"stone shadow"}))}});b.exports=e},{"../models/stone.js":15,react:"M6d2gk",underscore:"ZKusGn"}],uovHxG:[function(a,b){"use strict";var c=a("react"),d=(a("underscore"),a("lz-string")),e=(a("../models/board.js"),a("../models/stone.js"),a("../models/game.js")),f=a("../models/move.js"),g=a("./board_view.jsx"),h=c.createClass({displayName:"TesujiApp",handleClick:function(a){if(a){var b=a.x,c=a.y;if(void 0!==b&&void 0!==c){var g=new e({moves:this.props.game.moves.concat(new f({x:b,y:c,color:this.props.game.current_turn})),current_turn:(this.props.game.current_turn+1)%2});g.board()&&(window.location.href="#/game/"+d.compressToBase64(JSON.stringify(g)))}}},render:function(){return c.DOM.div(null,g({board:this.props.game.board(),current_turn:this.props.game.current_turn,onIntersectionClick:this.handleClick}),c.DOM.div(null,JSON.stringify(this.props.game)),c.DOM.div(null,d.compressToBase64(JSON.stringify(this.props.game))))}});b.exports=h},{"../models/board.js":11,"../models/game.js":"FA0ZaN","../models/move.js":14,"../models/stone.js":15,"./board_view.jsx":2,"lz-string":1,react:"M6d2gk",underscore:"ZKusGn"}],tesuji_app:[function(a,b){b.exports=a("uovHxG")},{}],9:[function(a,b){var c=a("underscore"),d=function(){};d.prototype.initialize=function(a){return a},d.extend=function(a){var b=this,d=function(b){c.extend(this,this.initialize(c.defaults(void 0!==b?b:{},a.defaults)))};return c.extend(d,b),d.prototype=c.extend(Object.create(b.prototype),a.methods),d},b.exports=d},{underscore:"ZKusGn"}],10:[function(a,b){var c=a("underscore"),d=a("../models/stone.js"),e=(a("../models/board.js"),function(a){this.message=a,this.name="InvalidMoveException"}),f={playMove:function(a,b){var c=a.slice(-1)[0];if(c.stoneAt(b.x,b.y))throw new e("stone already at ("+b.x+", "+b.y+")");var f=new d(b),g=c.placeStones(f),h=g.findKills(f);if(g=g.removeStones(h),this.checkSuicide(g,f))throw new e("stone placed in suicide");if(h&&h.length>0&&this.checkKo(a,g))throw new e("move violates rule of ko");return g},checkSuicide:function(a,b){return a.findDeadStones(b).length>0},checkKo:function(a,b){return a.some(function(a){return b.stones.length===a.stones.length&&c.isEqual(a.getOverlay(),b.getOverlay())})}};b.exports=f},{"../models/board.js":11,"../models/stone.js":15,underscore:"ZKusGn"}],11:[function(a,b){var c=a("underscore"),d=a("../lib/model.js"),e=d.extend({attributes:["board_size","stones"],methods:{initialize:function(a){return c.defaults(a,{board_size:19,stones:[]})},_coordinatesToIndex:function(a,b){return a+this.board_size*b},coordinatesOutOfBounds:function(a,b){return 0>a||a>=this.board_size||0>b||b>=this.board_size},stoneAt:function(a,b){return this.coordinatesOutOfBounds(a,b)?void 0:c.first(c.where(this.stones,{x:a,y:b}))||null},neighbors:function(a){return[this.stoneAt(a.x-1,a.y),this.stoneAt(a.x,a.y+1),this.stoneAt(a.x+1,a.y),this.stoneAt(a.x,a.y-1)]},getOverlay:function(a){var b=void 0!==a?a:this.stones;return c.object(b.map(function(a){return a.x+this.board_size*a.y}.bind(this)),b)},placeStones:function(){args=c.flatten(arguments);var a=c.filter(args,function(a){return!this.coordinatesOutOfBounds(a.x,a.y)&&!this.stoneAt(a.x,a.y)}.bind(this));return 0===a.length?null:new e({board_size:this.board_size,stones:this.stones.concat(a)})},removeStones:function(){args=c.flatten(arguments);var a=c.filter(args,function(a){return!this.coordinatesOutOfBounds(a.x,a.y)&&a===this.stoneAt(a.x,a.y)}.bind(this));return 0===a.length?this:new e({board_size:this.board_size,stones:c.values(c.omit(this.getOverlay(),c.keys(this.getOverlay(a))))})},findKills:function(a){return c.reduce(this.neighbors(a).filter(function(b){return b&&a.color!==b.color}),function(a,b){return c.contains(a,b)?a:a.concat(this.findDeadStones(b))}.bind(this),[])},findDeadStones:function(a){return function b(a,d,e){if(0===d.length)return e;var f=d[0],g=a.neighbors(f);return g.indexOf(null)>=0?[]:b(a,d.slice(1).concat(g.filter(function(a){return a&&f.color===a.color&&!c.contains(e,a)})),e.concat(f))}(this,[a],[])}}});b.exports=e},{"../lib/model.js":9,underscore:"ZKusGn"}],FA0ZaN:[function(a,b){var c=(a("underscore"),a("../lib/model.js")),d=a("../lib/rules.js"),e=a("./board.js"),f=a("./stone.js"),g=a("./move.js"),h=c.extend({attributes:["moves","handicap","komi","black_player","white_player","current_turn"],defaults:{moves:[],handicap:0,current_turn:f.BLACK},methods:{initialize:function(a){return a.moves.length>0&&(a.moves=a.moves.map(function(a){return new g(a)})),a},board:function(){return function a(b,c){if(0===c.length)return b.slice(-1)[0];var e=d.playMove(b,c[0]);return a(b.concat(e),c.slice(1))}([new e],this.moves)}}});b.exports=h},{"../lib/model.js":9,"../lib/rules.js":10,"./board.js":11,"./move.js":14,"./stone.js":15,underscore:"ZKusGn"}],game:[function(a,b){b.exports=a("FA0ZaN")},{}],14:[function(a,b){var c=a("../lib/model.js"),d=c.extend({attributes:["x","y","color"]});b.exports=d},{"../lib/model.js":9}],15:[function(a,b){var c=(a("underscore"),a("../lib/model.js")),d=c.extend({attributes:["x","y","color"]});d.BLACK=0,d.WHITE=1,b.exports=d},{"../lib/model.js":9,underscore:"ZKusGn"}]},{},["uovHxG"]);var React=require("react"),TesujiApp=require("tesuji_app"),Router=require("director").Router,lz=require("lz-string"),Game=require("game"),routes={"/game":function(){console.log("errp!"),React.renderComponent(TesujiApp({game:new Game}),document.getElementById("tesuji_app"))},"/game/.*":function(){var a;try{a=JSON.parse(lz.decompressFromBase64(window.location.hash.slice(7)))}catch(b){try{a=JSON.parse(atob(window.location.hash.slice(7)))}catch(c){console.log("inavlid game data: "+b)}}var d=a?new Game(a):new Game;React.renderComponent(TesujiApp({game:d}),document.getElementById("tesuji_app"))},"/errp":function(){console.log("derrp")}},router=new Router(routes);router.init();